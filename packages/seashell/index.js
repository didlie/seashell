module.exports=function(e){function t(n){if(r[n])return r[n].exports;var a=r[n]={exports:{},id:n,loaded:!1};return e[n].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,exports,t){e.exports=t(1)},function(e,exports,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Router=exports.App=exports.Hub=void 0;var n=t(2),a=r(n),u=t(31),o=r(u),s=t(15),c=r(s);exports.Hub=a["default"],exports.App=o["default"],exports.Router=c["default"]},function(e,exports,t){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=t(3),u=n(a),o=t(4),s=n(o),c=t(5),i=n(c),l=t(6),f=n(l),p=t(7),d=n(p),h=t(8),v=n(h),_=t(9),k=n(_),S=t(10),x=n(S),b=t(11),E=n(b),g=t(12),m=n(g),y=t(14),I=n(y),R=t(18),w=r(R),O=t(29),A={port:3311,presets:[]},T=function(e){function t(){var e,r,n,a,o=this;(0,v["default"])(this,t);for(var c=arguments.length,l=Array(c),p=0;p<c;p++)l[p]=arguments[p];return r=n=(0,k["default"])(this,(e=(0,d["default"])(t)).call.apply(e,[this].concat(l))),n.state={},n.handleRequest=function(){var e=(0,f["default"])(i["default"].mark(function t(e,r){var a,u,s,c,l;return i["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.state.io,t.prev=1,r.headers.callbackId){t.next=4;break}throw new Error("LOST_CALLBACK_ID");case 4:return r.headers.__SEASHELL_START=Date.now(),u=r.headers.importAppName,t.next=8,w.getAppBySocketId(e.id);case 8:if(s=t.sent,console.log(O.SeashellChalk+" "+s.appName+" --> "+r.headers.importAppName+r.headers.originUrl),"admin"!=u){t.next=12;break}return t.abrupt("return",n.handleAdminRequest(e,r));case 12:return t.next=14,w.getResSocketIdWithBalance(u);case 14:c=t.sent,a.sockets.connected[c].emit("PLEASE_HANDLE_THIS_REQUEST",r),t.next=24;break;case 18:t.prev=18,t.t0=t["catch"](1),console.log(t.t0.stack||t.t0),l={headers:{callbackId:r.headers.callbackId},body:{error:"string"==typeof t.t0?t.t0:"HUB_EXCEPTION_ERROR"}},e.emit("YOUR_REQUEST_HAS_RESPONSE",l),console.log(O.SeashellChalk+" request failed because "+t.t0);case 24:case"end":return t.stop()}},t,o,[[1,18]])}));return function(t,r){return e.apply(this,arguments)}}(),n.handleAdminRequest=function(){var e=(0,f["default"])(i["default"].mark(function t(e,r){var n,a,u;return i["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=I["default"].handleLoop,console.log(O.SeashellChalk+" handle admin request: "+(0,s["default"])(r)),a={headers:{appId:r.headers.appId,callbackId:r.headers.callbackId},body:{},end:function(){e.emit("YOUR_REQUEST_HAS_RESPONSE",{headers:a.headers,body:a.body})}},u=function o(e,t,r,a,u){return n(e,t,r,o,a,u)},u(null,r,a,0,r.headers.originUrl);case 5:case"end":return t.stop()}},t,o)}));return function(t,r){return e.apply(this,arguments)}}(),n.handleResponse=function(){var e=(0,f["default"])(i["default"].mark(function t(e,r){var a,u;return i["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.state.io,e.prev=1,r.headers.appId){e.next=4;break}throw new Error("Export Lost Params: [appId]");case 4:if(r.headers.callbackId){e.next=6;break}throw new Error("Export Lost Params: [callbackId]");case 6:return e.next=8,w.getSocketByAppId(r.headers.appId);case 8:u=e.sent,a.sockets.connected[u.socketId].emit("YOUR_REQUEST_HAS_RESPONSE",r),console.log(O.SeashellChalk+" "+u.appName+" <-- "+r.headers.importAppName+r.headers.originUrl+","+(" total spend "+(Date.now()-r.headers.__SEASHELL_START)+"ms")),e.next=18;break;case 13:if(e.prev=13,e.t0=e["catch"](1),"REQUEST_SOCKET_OFFLINE"!=e.t0){e.next=17;break}return e.abrupt("return",console.log(O.SeashellChalk+" reqSocket offline"));case 17:console.log(e.t0.stack||e.t0);case 18:case"end":return e.stop()}},t,o,[[1,13]])}));return function(t,r){return e.apply(this,arguments)}}(),n.handleRegister=function(){var e=(0,f["default"])(i["default"].mark(function t(e,r){var n,a,u;return i["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e.id){t.next=3;break}throw"LOST_SOCKET_ID";case 3:return n={appName:r.appName,appId:r.appId,appSecret:r.appSecret},t.next=6,w.bindAppToSocket(e.id,n);case 6:a=t.sent,console.log(O.SeashellChalk+" register success, data: "+(0,s["default"])(r)),e.emit("YOUR_REGISTER_HAS_RESPONSE",{success:1,socketData:a}),t.next=16;break;case 11:t.prev=11,t.t0=t["catch"](0),console.log(O.SeashellChalk+" register failed, data: "+r),u="string"==typeof t.t0?t.t0:"EXCEPTION_ERROR",e.emit("YOUR_REGISTER_HAS_RESPONSE",{error:u});case 16:case"end":return t.stop()}},t,o,[[0,11]])}));return function(t,r){return e.apply(this,arguments)}}(),n.start=function(){var e=(0,f["default"])(i["default"].mark(function t(){var e,r,a=arguments.length<=0||void 0===arguments[0]?A:arguments[0];return i["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.state.isStarted){t.next=2;break}return t.abrupt("return",!1);case 2:return e=n,t.prev=3,r=(0,E["default"])(),e.setState({io:r}),t.next=8,w.emptySocket();case 8:return t.next=10,u["default"].all(a.presets.map(w.importServiceFromConfig));case 10:r.on("connection",function(t){console.log(O.SeashellChalk+" new connection "+t.id),t.on("REGISTER",function(r){e.handleRegister(t,r)}),t.on("I_HAVE_A_REQUEST",function(r){e.handleRequest(t,r)}),t.on("I_HAVE_HANDLE_THIS_REQUEST",function(r){e.handleResponse(t,r)}),t.on("disconnect",function(){var e=function(){var t=(0,f["default"])(i["default"].mark(function r(t){var n=arguments.length<=1||void 0===arguments[1]?0:arguments[1];return i["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,console.log(O.SeashellChalk+" "+t+" disconnected"),r.next=4,w.deleteSocket(t);case 4:r.next=9;break;case 6:r.prev=6,r.t0=r["catch"](0),n<3&&(n++,e(t,n));case 9:case"end":return r.stop()}},r,o,[[0,6]])}));return function(e,r){return t.apply(this,arguments)}}();e(t.id)})}),console.log("listening on port "+a.port),r.listen(a.port),t.next=19;break;case 15:throw t.prev=15,t.t0=t["catch"](3),console.log(t.t0.stack||t.t0),t.t0;case 19:case"end":return t.stop()}},t,o,[[3,15]])}));return function(t){return e.apply(this,arguments)}}(),a=r,(0,k["default"])(n,a)}return(0,x["default"])(t,e),t}(m["default"]);exports["default"]=T,e.exports=exports["default"]},function(e,exports){e.exports=require("babel-runtime/core-js/promise")},function(e,exports){e.exports=require("babel-runtime/core-js/json/stringify")},function(e,exports){e.exports=require("babel-runtime/regenerator")},function(e,exports){e.exports=require("babel-runtime/helpers/asyncToGenerator")},function(e,exports){e.exports=require("babel-runtime/core-js/object/get-prototype-of")},function(e,exports){e.exports=require("babel-runtime/helpers/classCallCheck")},function(e,exports){e.exports=require("babel-runtime/helpers/possibleConstructorReturn")},function(e,exports){e.exports=require("babel-runtime/helpers/inherits")},function(e,exports){e.exports=require("socket.io")},function(e,exports,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var n=t(13),a=r(n),u=t(8),o=r(u),s=function c(){var e=this;(0,o["default"])(this,c),this.setState=function(t){e.state=(0,a["default"])({},e.state,t)}};exports["default"]=s,e.exports=exports["default"]},function(e,exports){e.exports=require("babel-runtime/core-js/object/assign")},function(e,exports,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var n=t(15),a=r(n),u=new a["default"];u.use(function(e,t,r){t.json=function(e){t.body=e,t.end()},t.error=function(e){t.json({error:e})},r()}),u.use("/service/create",t(17)),u.use("/service/delete",t(24)),u.use("/service/enable",t(25)),u.use("/service/disable",t(26)),u.use("/service/list",t(27)),u.use("/group/list",t(28)),u.use(function(e,t,r,n){return"string"==typeof e?r.error(e.toUpperCase()):void r.error("EXCEPTION_ERROR")}),u.use(function(e,t){t.error("ROUTER_NOT_FOUND")}),exports["default"]=u,e.exports=exports["default"]},function(e,exports,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var n=t(5),a=r(n),u=t(6),o=r(u),s=t(7),c=r(s),i=t(8),l=r(i),f=t(9),p=r(f),d=t(10),h=r(d),v=t(12),_=r(v),k=t(16),S=r(k),x=function(e){function t(){for(var e,r,n,u,s=arguments.length,i=Array(s),f=0;f<s;f++)i[f]=arguments[f];return(0,l["default"])(this,t),r=n=(0,p["default"])(this,(e=(0,c["default"])(t)).call.apply(e,[this].concat(i))),n.exportActionStack=[],n.use=function(){var e,t;1==arguments.length?(e="",t=arguments[0]):(e=arguments[0],t=arguments[1]);var r=this.exportActionStack,n={path:e,isErrorHandle:!1};t instanceof Function?(n.isErrorHandle=(0,S["default"])(t),n.fn=t):n.router=t,r.push(n)},n.handleLoop=function(e,t,r,u,s,c){function i(e){var n=function(){var n=(0,o["default"])(a["default"].mark(function u(n,o){var s;return a["default"].wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,"error"!=n){a.next=3;break}return a.abrupt("return",o.fn(e,t,r,i));case 3:if("router"!=n){a.next=6;break}return s=c.substr(o.path.length),a.abrupt("return",o.router.handleLoop(e,t,r,i,p,s));case 6:return a.next=8,o.fn(t,r,i);case 8:return a.abrupt("return",a.sent);case 11:a.prev=11,a.t0=a["catch"](0),i(a.t0);case 14:case"end":return a.stop()}},u,this,[[0,11]])}));return function(e,t){return n.apply(this,arguments)}}();if(p++,p>=f.length)return u(e,t,r,u,s);var l=f[p];if(l.isErrorHandle)return e?n("error",l):i();if(e)return i(e);if(l.router)return n("router",l);if("undefined"!=typeof l.path){if(""!=l.path&&c!=l.path)return i();n(null,l)}}var l=n,f=l.exportActionStack,p=-1;i(e)},u=r,(0,p["default"])(n,u)}return(0,h["default"])(t,e),t}(_["default"]);exports["default"]=x,e.exports=exports["default"]},function(e,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(e){try{return 4==e.toString().match(/[A-Z0-9a-z,(\s]*\)/)[0].split(",").length}catch(t){return!1}};exports["default"]=t,e.exports=exports["default"]},function(e,exports,t){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}var a=t(5),u=n(a),o=t(6),s=n(o),c=t(18),i=r(c);e.exports=function(){var e=(0,s["default"])(u["default"].mark(function t(e,r,n){var a;return u["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.createServiceByName(e.body.serviceName);case 2:a=t.sent,r.json({service:a});case 4:case"end":return t.stop()}},t,void 0)}));return function(t,r,n){return e.apply(this,arguments)}}()},function(e,exports,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.importServiceFromConfig=exports.createServiceByName=exports.getResSocketIdWithBalance=exports.bindAppToSocket=exports.getSocketByAppId=exports.getAppBySocketId=exports.deleteSocket=exports.emptySocket=void 0;var n=t(13),a=r(n),u=t(5),o=r(u),s=t(6),c=r(s),i=t(3),l=r(i),f=t(19),p=r(f),d=t(20),h=r(d),v=t(22),_=r(v),k=t(23),S=r(k),x=(0,S["default"])("./data/db/service",{valueEncoding:"json"}),b=(0,_["default"])(x),E=(exports.emptySocket=function(){return new l["default"](function(){var e=(0,c["default"])(o["default"].mark(function t(e,r){return o["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:x.get("group_list",function(){var t=(0,c["default"])(o["default"].mark(function n(t,a){var u,s,c;return o["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t){n.next=12;break}return n.prev=1,n.next=4,b.put("group_list",[]);case 4:e(),n.next=11;break;case 7:n.prev=7,n.t0=n["catch"](1),console.log(n.t0),r(n.t0);case 11:return n.abrupt("return",!1);case 12:return n.prev=12,n.next=15,l["default"].all(a.map(function(e){return b.get("group_"+e,{valueEncoding:"json"})}));case 15:return u=n.sent,s=u.reduce(function(e,t){return e.concat(t)},[]),c=s.map(function(e){return e.socketId}).filter(function(e){return"string"==typeof e}),n.next=20,l["default"].all(c.map(function(e){return b.del("socket_"+e)}));case 20:e(),n.next=29;break;case 23:if(n.prev=23,n.t1=n["catch"](12),"string"!=typeof n.t1){n.next=27;break}return n.abrupt("return",r(n.t1));case 27:console.log(n.t1.stack||n.t1),r("EMPTY_SOCKET_FAIL");case 29:case"end":return n.stop()}},n,void 0,[[1,7],[12,23]])}));return function(e,r){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}},t,void 0)}));return function(t,r){return e.apply(this,arguments)}}())},exports.deleteSocket=function(e){return new l["default"](function(){var t=(0,c["default"])(o["default"].mark(function r(t,n){var a;return o["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,b.del("socket_"+e);case 3:a=t.sent,t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](0),n(t.t0);case 9:case"end":return t.stop()}},r,void 0,[[0,6]])}));return function(e,r){return t.apply(this,arguments)}}())},exports.getAppBySocketId=function(e){return new l["default"](function(){var t=(0,c["default"])(o["default"].mark(function r(t,n){var a;return o["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,b.get("socket_"+e,{valueEncoding:"json"});case 3:a=r.sent,t(a),r.next=13;break;case 7:if(r.prev=7,r.t0=r["catch"](0),"string"!=typeof r.t0){r.next=11;break}return r.abrupt("return",n(r.t0));case 11:console.log(r.t0),n("NOT_FOUND");case 13:case"end":return r.stop()}},r,void 0,[[0,7]])}));return function(e,r){return t.apply(this,arguments)}}())},exports.getSocketByAppId=function(e){return new l["default"](function(){var t=(0,c["default"])(o["default"].mark(function r(t,n){var a,u,s,c;return o["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,b.get("service_"+e);case 3:return a=r.sent,r.next=6,b.get("group_"+a.appName);case 6:if(u=r.sent,s=u.findIndex(function(t){return t.appId==e}),!(s<0)){r.next=10;break}throw"APP_NOT_FOUND";case 10:return r.next=12,b.get("socket_"+u[s].socketId);case 12:c=r.sent,t(c),r.next=20;break;case 16:r.prev=16,r.t0=r["catch"](0),console.log(r.t0.stack||r.t0),n(r.t0);case 20:case"end":return r.stop()}},r,void 0,[[0,16]])}));return function(e,r){return t.apply(this,arguments)}}())},exports.bindAppToSocket=function(e,t){return new l["default"](function(){var r=(0,c["default"])(o["default"].mark(function n(r,u){return o["default"].wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.delegateYield(o["default"].mark(function s(){var n,u,c,i;return o["default"].wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,b.get("service_"+t.appId);case 2:if(n=o.sent,n.appSecret==t.appSecret){o.next=5;break}throw"ERROR_REGISTER_INFO";case 5:return u=(0,a["default"])({},n,{socketId:e}),o.next=8,b.put("socket_"+e,u);case 8:return o.next=10,E(n.appName);case 10:return c=o.sent,i=c.findIndex(function(e){return e.appId==n.appId}),c[i]=(0,a["default"])({},c[i],{socketId:e,status:1}),o.next=15,b.put("group_"+n.appName,c);case 15:r(u);case 16:case"end":return o.stop()}},s,void 0)})(),"t0",2);case 2:n.next=10;break;case 4:if(n.prev=4,n.t1=n["catch"](0),"string"!=typeof n.t1){n.next=8;break}return n.abrupt("return",u(n.t1));case 8:console.log(n.t1),u("REGISTER_FAIL");case 10:case"end":return n.stop()}},n,void 0,[[0,4]])}));return function(e,t){return r.apply(this,arguments)}}())},exports.getResSocketIdWithBalance=function(e){return new l["default"](function(){var t=(0,c["default"])(o["default"].mark(function r(t,n){var a;return o["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,b.get("group_"+e,{valueEncoding:"json"});case 3:if(a=r.sent,0!=a.length){r.next=6;break}throw"TARGET_SERVICE_OFFLINE";case 6:if(1!=a.length){r.next=8;break}return r.abrupt("return",t(a[0].socketId));case 8:return r.abrupt("return",t(a[0].socketId));case 11:if(r.prev=11,r.t0=r["catch"](0),"string"!=typeof r.t0){r.next=15;break}return r.abrupt("return",n(r.t0));case 15:console.log(r.t0.stack||r.t0),n("GET_SOCKET_FAIL");case 17:case"end":return r.stop()}},r,void 0,[[0,11]])}));return function(e,r){return t.apply(this,arguments)}}())},function(e){return new l["default"](function(){var t=(0,c["default"])(o["default"].mark(function r(t,n){return o["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,b.get("group_"+e);case 3:r.t0=r.sent,t(r.t0),r.next=12;break;case 7:return r.prev=7,r.t1=r["catch"](0),r.next=11,b.put("group_"+e,[],{valueEncoding:"json"});case 11:t([]);case 12:case"end":return r.stop()}},r,void 0,[[0,7]])}));return function(e,r){return t.apply(this,arguments)}}())});exports.createServiceByName=function(e){return new l["default"](function(){var t=(0,c["default"])(o["default"].mark(function r(t,n){var a,u;return o["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,E(e);case 3:return a=r.sent,u={appId:p["default"].v4(),appName:e,appSecret:(0,h["default"])()},a.push({appId:u.appId,socketId:null,status:0}),r.next=8,l["default"].all([b.put("group_"+e,a,{valueEncoding:"json"}),b.put("service_"+u.appId,u,{valueEncoding:"json"})]);case 8:t(u),r.next=17;break;case 11:if(r.prev=11,r.t0=r["catch"](0),"string"!=typeof r.t0){r.next=15;break}return r.abrupt("return",n(r.t0));case 15:console.log(r.t0),n("CREATE_SERVICE_FAIL");case 17:case"end":return r.stop()}},r,void 0,[[0,11]])}));return function(e,r){return t.apply(this,arguments)}}())},exports.importServiceFromConfig=function(e){return new l["default"](function(){var t=(0,c["default"])(o["default"].mark(function r(t,n){var a,u,s;return o["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,E(e.appName);case 3:if(a=r.sent,u=a.findIndex(function(t){return console.log(t.appId,e.appId),t.appId==e.appId}),!(u>-1)){r.next=7;break}return r.abrupt("return",t(a[u]));case 7:return s={appId:e.appId,appName:e.appName,appSecret:e.appSecret},a.push({appId:s.appId,socketId:null,status:0}),r.next=11,l["default"].all([b.put("group_"+e.appName,a),b.put("service_"+s.appId,s)]);case 11:t(s),r.next=20;break;case 14:if(r.prev=14,r.t0=r["catch"](0),"string"!=typeof r.t0){r.next=18;break}return r.abrupt("return",n(r.t0));case 18:console.log(r.t0.stack||r.t0),n("CREATE_SERVICE_FAIL");case 20:case"end":return r.stop()}},r,void 0,[[0,14]])}));return function(e,r){return t.apply(this,arguments)}}())}},function(e,exports){e.exports=require("uuid")},function(e,exports,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var n=t(21),a=r(n),u=function(){return a["default"].randomBytes(512)};exports["default"]=u,e.exports=exports["default"]},function(e,exports){e.exports=require("crypto")},function(e,exports){e.exports=require("q-level")},function(e,exports){e.exports=require("levelup")},function(e,exports,t){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}var a=t(5),u=n(a),o=t(6),s=n(o),c=t(18),i=r(c);e.exports=function(){var e=(0,s["default"])(u["default"].mark(function t(e,r,n){var a;return u["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.deleteService(e.body.appId);case 2:a=t.sent,r.json({appId:e.body.appId});case 4:case"end":return t.stop()}},t,void 0)}));return function(t,r,n){return e.apply(this,arguments)}}()},function(e,exports){"use strict";e.exports=function(e,t,r){t.json({})}},function(e,exports){"use strict";e.exports=function(e,t,r){t.json({})}},function(e,exports){"use strict";e.exports=function(e,t,r){t.json({})}},function(e,exports,t){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}var a=t(5),u=n(a),o=t(6),s=n(o),c=t(18),i=r(c);e.exports=function(){var e=(0,s["default"])(u["default"].mark(function t(e,r,n){var a;return u["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.getGroupList();case 2:a=e.sent;case 3:case"end":return e.stop()}},t,void 0)}));return function(t,r,n){return e.apply(this,arguments)}}()},function(e,exports,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.SeashellChalk=void 0;var n=t(30),a=r(n);exports.SeashellChalk=a["default"].blue.bold("[Seashell]")},function(e,exports){e.exports=require("chalk")},function(e,exports,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var n=t(3),a=r(n),u=t(32),o=r(u),s=t(5),c=r(s),i=t(4),l=r(i),f=t(6),p=r(f),d=t(7),h=r(d),v=t(8),_=r(v),k=t(9),S=r(k),x=t(10),b=r(x),E=t(19),g=r(E),m=t(33),y=r(m),I=t(15),R=r(I),w=t(34),O=r(w),A=t(29),T=function(e){function t(){var e,r,n,u,s=this;(0,_["default"])(this,t);for(var i=arguments.length,f=Array(i),d=0;d<i;d++)f[d]=arguments[d];return r=n=(0,S["default"])(this,(e=(0,h["default"])(t)).call.apply(e,[this].concat(f))),n.state={isStarted:!1,isOnline:!1,isRegistered:!1,importEmitterStack:{}},n.handleRequest=function(){var e=(0,p["default"])(c["default"].mark(function t(e){var r,a,u,o,i,f;return c["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=n.state.socket,a=n,u=a.handleLoop,o=a.exportActionStack,console.log(A.SeashellChalk+" handle request: "+(0,l["default"])(e)),i={headers:e.headers,body:{},end:function(){r.emit("I_HAVE_HANDLE_THIS_REQUEST",{headers:i.headers,body:i.body})}},f=function s(e,t,r,n,a){return u(e,t,r,s,n,a)},f(null,e,i,0,e.headers.originUrl);case 8:case"end":return t.stop()}},t,s)}));return function(t){return e.apply(this,arguments)}}(),n.request=function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if("object"!=("undefined"==typeof t?"undefined":(0,o["default"])(t)))throw A.SeashellChalk+" request data must be an object.";var r=n.state,u=r.socket,s=r.importEmitterStack,c=r.appId;return new a["default"](function(r,a){try{var i=function(){if(!n.state.isOnline)return{v:a("YOUR_SERVICE_IS_OFFLINE")};var o=g["default"].v4(),i={body:t,headers:{appId:c,callbackId:o}},f=e.search("/");if(f<0)i.headers.importAppName=e,i.headers.originUrl="/";else{var p=0==f?e.substr(1):e,d=p.search("/");i.headers.importAppName=p.substring(0,d),i.headers.originUrl=p.substring(d)}console.log(A.SeashellChalk+" Start request servicehub, data: "+(0,l["default"])(i)),s[o]=new O["default"],s[o].on("RESPONSE",function(e){return r(e),delete s[o],null}),u.emit("I_HAVE_A_REQUEST",i)}();if("object"===("undefined"==typeof i?"undefined":(0,o["default"])(i)))return i.v}catch(f){console.log(A.SeashellChalk+" "+(f.stack||f)),a(f)}})},n.requestStream=function(){},n.connect=function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(n.state.isStarted)return!1;console.log(A.SeashellChalk+" connection options: "+(0,l["default"])(e));var t=n,r=n,a=r.handleRequest,u=(0,y["default"])(e.url);n.setState({opts:e,appId:e.key.appId,isStarted:!0,socket:u}),u.on("connect",function(){console.log(A.SeashellChalk+" connected"),console.log(A.SeashellChalk+" register"),t.setState({isOnline:!0}),u.emit("REGISTER",e.key)}),u.on("YOUR_REGISTER_HAS_RESPONSE",function(e){t.setState({isRegistered:!0})}),u.on("YOUR_REQUEST_HAS_RESPONSE",function(e){var r=n.state.importEmitterStack,a=e.headers.callbackId;r[a].emit("RESPONSE",e),delete r[a],t.setState({importEmitterStack:r})}),u.on("PLEASE_HANDLE_THIS_REQUEST",a),u.on("disconnect",function(){console.log(A.SeashellChalk+" lost connection"),t.setState({isOnline:!1})})},n.disconnect=function(){if(n.state.isStarted){var e=n.state.socket;e.disconnect()}console.log(A.SeashellChalk+" disconnected")},u=r,(0,S["default"])(n,u)}return(0,b["default"])(t,e),t}(R["default"]);exports["default"]=T,e.exports=exports["default"]},function(e,exports){e.exports=require("babel-runtime/helpers/typeof")},function(e,exports){e.exports=require("socket.io-client")},function(e,exports,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var n=t(8),a=r(n),u=function o(){var e=this;(0,a["default"])(this,o),this.state={},this.on=function(t,r){if("function"==typeof r)return e.state[t]=r},this.emit=function(t,r){"function"==typeof e.state[t]&&e.state[t](r)}};exports["default"]=u,e.exports=exports["default"]}]);